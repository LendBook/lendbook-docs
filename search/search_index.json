{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"What is LendBook ?","text":"<p>LendBook is a Lending Limit Order Book. It's the fusion of a limit order book and a lending protocol. LendBook is a non-custodial and permissionless lending protocol that enables users to borrow limit orders\u2019 assets. </p> <p>LendBook was designed to be the most robust protocol for supplying, borrowing, and achieving the highest leverage in the market.</p> What is a limit order book? <p>A limit order book is a list that shows all buy and sell orders for assets like cryptocurrencies (e.g. USDC and ETH). People place orders to buy or sell at specific prices, and these orders are displayed in the list. The highest buyer's price and lowest seller's price are at the top of the list. When a buyer and seller agree on a price, a trade happens, updating the order book. It's a dynamic marketplace, showing asset supply and demand at various price levels.</p> What is a lending protocol? <p>In decentralized finance, with a lending protocol, you can lend or borrow money using cryptocurrencies. If you have extra cryptocurrency, you can lend it, and if you need money, you can borrow it. How much you can borrow depends on the amount of cryptocurrency you provide as collateral. Smart contracts on blockchain manage the loans, and borrowers pay interest to lenders.  It's a way to earn interest on your crypto or get a loan without involving centralised financial institutions.</p> Main Logic <p>Users can lend and borrow limit orders' assets :</p> <ul> <li>Lenders post buy orders within a restricted set of limit prices. These orders can be borrowed.</li> <li>Borrowers deposit collateral to borrow assets from a pool of buy orders.</li> <li>Liquidation occurs when the market price crosses the limit price. Lenders receive collateral from borrowers.</li> </ul> <p> </p> An example : (1) Alice deposits some USDC as a buy order at price 3000 USDC. (2) Bob deposits some ETH as collateral. (3) With this ETH as collateral, he can then borrow USDC from the pool of buy orders."},{"location":"advantages/automated-market-making/","title":"Automated market making","text":"<p>Orders which assets are filled are automatically replaced in the order book (Main Rule n\u00b06). Lenders choose at which limit price their assets are replaced. By default, their liquidity is posted as a limit order in the pool closest to the market price on the other side of order book.</p> <p>Example with pools-of-orders spaced with a 10% step: </p> <p>In the ETH/USDC market, let's suppose market price is 2110. </p> <p>Alice deposits 6000 in a buy order which limit price is 2000. Once the market price reaches 2000 and the order is filled, the protocol relocates the 3 ETH in the nearer pool of sell orders which is Pool<sub>2200</sub> with a limit price of 2200.</p> <p>This feature allows lenders (or protocols built on LendBook) to program in advance at which price they are willing to sell back the assets after a buy, or buy back them after a sell. The default strategy with automatic replacing in the nearest opposite pool is similar to what liquidity providers experience in Uniswap-type Automated Market Makers (AMMs), except that instead of earning a fee rate, lenders earn the spread on top of the interest rate paid by borrowers.</p> <p>Example (continued) </p> <p>Now, the market price is 2000, and Alice has a sell order of 3 ETH deposited in the Pool<sub>2200</sub>.</p> <p>Let's suppose the market price goes up and crosses 2200. </p> <p>Alice\u2019s sell order is taken for 6600 USDC (=3\u00d72200). Her net profit is 600 USDC (=6600-6000). Her profit rate is 10% (=600/6000).</p> <p>From there, two types of lending strategies are made possible :</p> <ol> <li> <p>Lenders act as market makers and post limit orders closed to current price. They constantly (and automatically) replace their filled order on the other side of the market to earn the spread in addition to the lending return rate. </p> </li> <li> <p>Lenders follow single-sided Aave-style strategies. They earn a return for their deposited assets but avoid conversion by posting limit orders far from current price and/or by withdrawing their funds before their orders are filled.</p> </li> </ol>"},{"location":"advantages/debt-management/","title":"Simple debt management","text":"Check out the market price <p>By choosing the pool-of-orders from which the borrower borrows, he therefore chooses the price at which he wishes to be liquidated.  To avoid liquidation, the borrower simply needs to follow the market price and remember at what limit price he has placed his loan.</p> <p> Borrowers set the prices at which their positions are closed for a loss.</p> Check out your excess collateral <p>If the borrower doesn't want to over-collateralize his loan, he can track his excess collateral and when his excess collateral falls below a given threshold, he can repay his loan or add more collateral.</p>"},{"location":"advantages/governance/","title":"Minimized governance","text":""},{"location":"advantages/governance/#governance-is-too-central-in-most-of-lending-protocols","title":"Governance is too central in most of lending protocols","text":"<p>The governance activity of lending protocols has significantly grown and become more complex over time. Managing the risks of pools has been progressively delegated to experts, whose mission is to monitor the asset markets and update pools\u2019 risk parameters. This involves assessing multiple risk factors, such as assets\u2019 on-chain liquidity, their price volatility and market capitalization.</p> <p>Governance-driven risk management hinders protocols from scaling horizontally. The more assets are listed, the greater the number of risk parameters that need to be monitored and updated in real-time. The DAO, with its limited scope for attention and complex decision process, becomes a bottleneck in expanding to more chains and assets.</p> <p>Moreover, protocols\u2019 solvency is still at risk of a lack of due diligence or governance failure. </p>"},{"location":"advantages/governance/#lendbook-on-the-path-to-full-decentralization","title":"LendBook, on the path to full decentralization","text":"<p>Lending Limit Order Book is fully algorithmic and automated.</p> <p>As pools\u2019 solvency does not rely on team\u2019s interventions or governance by a DAO, full decentralization becomes a credible objective which LendBook will actively pursue. The protocol will ultimately be governance free with non-upgradeable smart contracts and parameters set at the time of contract deployment.</p> <p>No governance process will be needed to whitelist approved tokens. Markets will be created permissionlessly by calling a factory contract. The number of assets that could be listed is only limited by the existence of a reliable price feed in LendBook V1. LendBook V2 will expand to long-tail assets by getting rid of price oracles.</p>"},{"location":"advantages/leverage/","title":"Leverage","text":"<p>LendBook enables leverage factors a magnitude higher than what other lending protocols offer. </p> <p>To understand how, let\u2019s examine how traders leverage their position. As in other protocols, they can borrow Y and swap them to amplify their position in X, or they can borrow X and swap them to short X. Borrowers can easily do loops of borrowing and swapping to amplify their leverage. High LTV translates into high leverage. Abstracting from gas and swap costs, the n-loop maximum leverage factor is:</p> <p> \\(1+LTV+LTV^2+...+LTV^n\\) </p> <p>Assuming borrowers could infinitely loop at the same limit price, their maximum leverage would be :</p> <p> \\(\\dfrac{1}{1-maxLTV}\\) </p> <p>As the limit price gets closer to the market price, the max LTV tends to aLTV. We can then calculate the theoretical maximum leverage for each type of asset pair :</p> Asset tier MaxLTV Theoretical Max leverage Examples Pegged assets 98.5% x66 DAI/USDC, wstETH/ETH Correlated assets 96% x25 USDM/USDC, FRAX/USDC Volatile assets 94% x16 ETH/USDC, WBTC/ETH Long-tail assets (in V2) 92% x12 MKR/ETH, LINK/ETH"},{"location":"advantages/liquidation-cost/","title":"Low liquidation cost","text":"<p>In most of lending protocols, the prevalent liquidation mechanism allows a liquidator to repay a fraction of the borrower\u2019s debt and acquire its collateral at a discount. </p> <p>In LendBook, when the price crosses a limit price, the closing of a borrowing position does not rely on the active monitoring of liquidators but on that of takers. Takers, by taking the non-borrowed part of the assets, initiate the internal transfer from the borrowers to the lenders. </p> <p>Since lenders agree to receive the collateral as a payment, the protocol does not need to incentivize bots to liquidate unhealthy positions on time. The borrower only pays small liquidation fee rate, with the goal to compensate lenders for receiving the collateral and give borrowers incentives to repay their loan before liquidation.</p> <p> More information on liquidation</p>"},{"location":"advantages/loan-to-value-leverage/","title":"High LTV and high leverage","text":"<p> More information on Loan-To-Value</p> <p>LendBook offers higher leverage than other lending protocols. </p> <p>To understand how, let\u2019s examine how borrowers leverage their position. As in other protocols, they can borrow Y and swap them to amplify their position in X, or they can borrow X and swap them to short X. Borrowers can easily do loops of borrowing and swapping to amplify their leverage. High LTV translates into high leverage. Abstracting from gas and swap costs, the n-loop maximum leverage factor is:</p> <p> \\(1+LTV+LTV^2+...+LTV^n\\) </p> <p>Assuming borrowers could infinitely loop at the same limit price, their maximum leverage would be :</p> <p> \\(\\dfrac{1}{1-maxLTV}\\) </p> <p>As the limit price gets closer to the market price, the maxLTV tends towards LLTV (Liquidation Loan-To-Value). We can then calculate the theoretical maximum leverage for each type of asset pair :</p> Asset tier LLTV pool step MaxLTV for pool closest to market price Theoretical Max leverage Examples Pegged assets 99% 0.03% from 98.9% to 99% x100 DAI/USDC, wstETH/ETH Correlated assets 98% 1% from 97% to 98% x50 USDM/USDC, FRAX/USDC Volatile assets 96% 10% from 87.3% to 96% x25 ETH/USDC, WBTC/ETH Long-tail assets (in V2) 94% 15% from 81.7% to 94% x16 MKR/ETH, LINK/ETH"},{"location":"advantages/loan-to-value/","title":"Loan to value","text":"<p>When a pool-of-orders is close to the market price, maxLTV tends towards aLTV.</p> <p>For each type of asset pair, we can calculate the interval of maxLTV for the pool-of-orders closest to the market price :</p> Asset tier aLTV pool step MaxLTV for pool closest to market price Examples Pegged assets 98.5% 0.1% from 98.4% to 98.5% DAI/USDC, wstETH/ETH Correlated assets 96% 1% from 95% to 96% USDM/USDC, FRAX/USDC Volatile assets 94% 10% from 84.6% to 94% ETH/USDC, WBTC/ETH Long-tail assets (in V2) 92% 15% from 78.2% to 92% MKR/ETH, LINK/ETH <p> More information on Loan-To-Value</p>"},{"location":"advantages/risk-management/","title":"No bad debt / No off-chain risk management","text":"No bad debt <p>A major implication of borrowing assets from limit orders is the dramatic simplification and high safety of the liquidation process. Borrowing positions cannot go under-collateralized even in case of strong and rapid price action, gas fee spike, or blockchain congestion/downtime. </p> <p>While the risk of rapid price variation persists, it is borne by the maker of the limit order, creating an opportunity cost for them. Although this cost is inherent in all limit order books, in LendBook, lenders are compensated through an interest rate and liquidation fees.</p> <p>The fact that lending pools stay well collateralized under any market conditions brings many benefits at the UX and governance levels. In particular, there is no need for supervision by third party, funding a safety module, liquidation costs, or borrowing restrictions such as supply caps, borrowing caps and low loan-to-value.</p> No off-chain risk management <p>In most of lending protocols, risk management is off-chain and rely on DAO and/or third-parties.  In LendBook, the risk management is on-chain and market-driven.</p>"},{"location":"advantages/risk-management/#implication-how-high-volatility-assets-are-managed-in-lendbook-vs-other-protocols","title":"Implication: How high-volatility assets are managed in LendBook vs other protocols ?","text":"<ul> <li> <p>In protocols which use off-chain management,     DAOs and risk experts typically set lower collateral ratios in high volatility pools to give liquidators enough time to close risky positions and prevent the creation of bad debt in case of price fall.</p> </li> <li> <p>In LendBook,     lenders handle the risk of volatile assets by migrating their capital to limit prices far enough from market price to reduce the risk of their assets being converted at an unfavorable rate. Liquidity migh be scarcer at limit prices closer to market price which drives the corresponding pools\u2019 interest rate up and rewards lenders for the additional risk they take.</p> <p>By borrowing in pool-of-orders far from current price, borrowers benefit from lower LTV as in other lending protocols. The difference is that the lower LTV is not predetermined by an off-chain decision but the result of market forces and users\u2019 decision.</p> </li> </ul>"},{"location":"advantages/soft-pegged-assets/","title":"Soft pegged assets","text":"<p>LendBook is exceptionally well-suited for yield amplification in markets with pegged assets in which one is a yield-bearing version of the other. </p> <p>Let us illustrate the efficiency of LendBook with an example taken in the liquid staking derivative markets. The Uniswap V3 market wstETH/ETH is endowed with 27m liquidity with capital spread between prices 1.1458 and 1.1461 (observed on Nov. 13th 2023). Assuming a similar liquidity distribution on LendBook, the order book representation is :</p> <p> Capital distribution in the wstETH/ETH market similar to the Uniswap liquidity pool.</p> <p>A strategy amplifying the yield consists in depositing wstETH on the sell order side and borrowing ETH on the buy order side. Given a market price of 1.146, borrowing ETH at the limit price of 1.1458 would give users a LTV of 97.98% (=0.98 \u00d7 1.1458/1.1460). Exchanging on Uniswap the ETH for wstETH at a 0.01% fee rate would provide traders with an adjusted LTV of 97.97% (assuming no price impact). If the process could be infinitely repeated, the maximum leverage factor would be x49.</p> <p>In practice, the leverage factor will be less due to a finite number of rounds of borrowing. For a leverage factor of 30, given a wstETH APR of 3.9% and a borrow APY of 3%, leveraged APR would be 27% (=30 \u00d7 0.9%)</p>"},{"location":"advantages/stop-loss-take-profit/","title":"Stop loss take profit","text":"Stop loss <p>A stop-loss order allows traders to close long positions by selling the assets or a short position by buying the assets. In LendBook, users open stop-loss orders by borrowing assets from limit orders. The stop price in case of price decrease (or increase) is the limit price of the buy (sell) order from which they borrow.</p> Example <p>In the ETH/USDC market, let's suppose the market price is 2110.</p> <p>Bob deposits 2 ETH as a sell order in the Pool<sub>2200</sub> at limit price 2200.</p> <p>Bob borrows the maximum amount from Pool<sub>2000</sub> at a limit price of 2000 : He can borrow up to 3920 USDC (=0.98\u00d72\u00d72000). </p> <p>If the market price decreases to 2000, Bob's borrowing position is liquidated. Bob keeps the 3920 USDC and gives up his 2 ETH. This is as if he benefits from a stop loss (sell ETH when its price decreases) at the guaranteed price of 2000. His stop price is the limit price of the pool he borrowed from.</p> <p>(Interest rates are not included in this example)</p> <p>In traditional or crypto finance, once the stop price is met, the stop loss order becomes a market order and is executed at the next available price. The obtained price can be significantly less favorable than the specified price when markets move fast. Here the stop price is guaranteed by the filling of the sell order at the limit price.</p> Take profit <p>By posting their collateral in the order book, borrowers can program in advance the price at which they exit their strategy, which is the limit price of their collateral order.</p> Another example <p>In the ETH/USDC market, let's suppose the market price is 2110.</p> <p>Bob deposits 2 ETH as a sell order in the Pool<sub>2200</sub> at limit price of 2200. </p> <p>Bob borrows 3920 USDC (=0.98\u00d72\u00d72000) from Pool<sub>2000</sub> at a limit price of 2000.</p> <p>By depositing ETH in a sell order at 2200, Bob benefits from a take-profit at the same price. </p> <p>If the market price increases to 2200, Bob\u2019s sell order is filled and his borrowing position is closed out. His 2 ETH are exchanged against 4400 USDC (=2\u00d72200) from which 3920 are used to pay back his borrowing position. He keeps the 3920 USDC borrowed from the pool and earns a profit of 480 USDC (=4400-3920). Bob leaves with 4400 USDC.</p> <p>(Interest rates are not included in this example)</p> <p>Setting in advance an exit price is an integral part of risk management in case of leveraged position.</p> Another example <p>In the ETH/USDC market, let's suppose the market price is 2110.</p> <p>Bob deposits 2 ETH as collateral in as a sell order in the Pool<sub>2200</sub> at limit price of 2200. </p> <p>Bob borrows 3920 USDC (=0.98\u00d72\u00d72000) from Pool<sub>2000</sub> at a limit price of 2000.</p> <p>Bob swaps his loan for 1.86 ETH (=3920/2110) at market price 2110 and add this amount as collateral in his sell order in the Pool<sub>2200</sub>.</p> <p>Bob then borrows 3646 USDC (=0.98\u00d71.86\u00d72000) from Pool<sub>2000</sub> at a limit price of 2000. </p> <p>Bob swaps his loan for 1.73 ETH (=3646/2110) at market price 2110 and add this amount as collateral in his sell order in the Pool<sub>2200</sub>.</p> <p>If the market price increases 2200, his sell orders is filled and his borrowing positions are closed out. His 5.59 ETH (=2+1.86+1.73) are exchanged against 12298 USDC (=5.59\u00d72200) from which 7566 (=3920+3646) are used to pay back his borrowing positions. Bob\u2019s leveraged profit is 332 USDC (=12298-7566-2\u00d72200).  Bob leaves with 4732 USDC.</p> <p>(Interest rates are not included in this example)</p> <p>The combination of an order book with a lending protocol unlocks a rich set of strategies that borrowers can fine-tune and program in advance. They can spread their position over several collateral orders and pools with different limit prices. This way, their borrowing can be progressively reduced as the price reaches well-specified thresholds. </p> <p>For example, a Borrower can borrow from various pools in order to be liquidated gradually at various limit prices. Also, a borrower can deposit his collateral in various pools in order to gradually take profit.</p>"},{"location":"how-it-works/interest-rates/","title":"Interest Rates","text":"<p>Borrowers who borrow from a pool pay interest rates to the lenders in that same pool.</p> <p>The interest rate is calculated per pool of orders, and it depends on the pool's utilization rate. Interest rates are shared between all the lenders of a pool.</p> Calculation of the Utilization Rate <p>The liquidity deposited by lenders in a pool can be divided into different categories :</p> <ul> <li>Non-Borrowable liquidity : Liquidity which is not available for borrowing. It is left to incentivize takers to make a trade when the market price reaches the limit price. Indeed, the first trade of a taker is important because it activates the liquidation of all the borrowing positions from the pool. The ratio of the non-Borrowable liquidity is defined at the smart contract level (e.i. 10% of the liquidity).</li> <li>Borrowable liquidity :<ul> <li>Borrowed liquidity : Borrowable assets which are currently borrowed.</li> <li>Available Liquidity : Borrowable assets which are not yet borrowed. Borrowing or withdrawing from the pool reduces available liquidity.</li> </ul> </li> </ul> <p> The Utilization Rate (UR) is calculated per pool of orders. UR is the ratio between the Borrowed liquidity and the total of Borrowable liquidity :</p> <p> \\(UR = \\dfrac{Borrowed\\ liquidity}{Borrowed\\ liquidity + Available\\ liquidity}\\) </p> <p></p> <p>The UR has a maximum value of 100%. As long as UR is not equal to 100%, borrowers can borrow more, and lenders can withdraw their limit orders (before their orders are executed).</p> Calculation of the Interest Rate <p>The higher the pool\u2019s utilization rate (UR), the higher the Interest Rate (IR).</p> <p>The optimal utilization of a pool-of-orders is when most of the liquidity is borrowed, but lenders can still withdraw their orders and new borrowers can borrow from the pool. In order to achieve this, the borrowers\u2019 interest rate (IR) curve is split in two parts around the optimal utilization rate (UR<sup>\u2217</sup>). When the UR is under the UR<sup>\u2217</sup>, the IR slope is small. And when UR is above, it increases sharply.</p> <p></p> Equation of the Interest Rate curve <p>The IR curve is :  \\(\\begin{cases}     if\\ \\ UR \\leq UR^*\\ ;\\ IR = \\alpha+\\beta \\dfrac{UR}{UR^*} \\\\      if\\ \\ UR \\gt UR^*\\ ;\\ IR = \\alpha+\\beta +\\gamma \\dfrac{UR-UR^*}{1-UR^*}     \\end{cases}\\) \\(with\\ \u03b1,\\ \u03b2\\ and\\ \u03b3\\ three\\ positive\\ parameters\\ (\u03b3&gt;\u03b2)\\) </p> <p>The goal of the IR curve is to encourage new lenders to come and deposit liquidity into the pool when the IR is high in that pool. Or alternately, encourage borrowers to repay their debt in order to increase available liquidity and push the UR back below the UR<sup>*</sup>.</p> <p></p> <p>Example (continued from example in Pools of orders Section)</p> <p>For the ETH/USDC market, Bob borrowed 8k USDC from the Pool<sub>2000</sub>.</p> <p>For the Pool<sub>2000</sub>, let's calculate the Utilization Rate and the Interest Rate:</p> <p> </p> <p> </p> <p> So Bob have to pay an Interest Rate equals to 3.69%.</p>"},{"location":"how-it-works/liquidation/","title":"Liquidation fees","text":"<p>In LendBook, there are two types of liquidation:</p> <ul> <li> <p>Price-based liquidation when the market price reaches the pool limit price, borrowing positions are liquidated</p> </li> <li> <p>Interest-based liquidation when a collateralized position become under-collateralized due to the accumulation of interest rate (mainly for long-term borrowings)</p> </li> </ul> Price-based liquidation <p>In LendBook, when the price crosses a limit price, the closing of a borrowing position does not rely on the active monitoring of liquidators but on that of takers. Takers, by taking the non-borrowed part of the assets, initiate the internal transfer from the borrowers to the lenders.</p> <p>Borrowers pay liquidation fees to lenders (fee rate is between 0.5 and 5%, depending on asset volatility). The goal is to compensate lenders for receiving the collateral and give borrowers incentives to repay their loan before liquidation. </p> <p>Since lenders agree to receive the collateral as a payment (plus liquidation fees), the protocol does not need to incentivize bots to liquidate unhealthy positions on time. </p> Asset tier Liquidation fees Examples Pegged assets 0.5% DAI/USDC, wstETH/ETH Correlated assets 1% USDM/USDC, FRAX/USDC Volatile assets 3% ETH/USDC, WBTC/ETH Long-tail assets (in V2) 5% MKR/ETH, LINK/ETH Interest-based liquidation <p>As time goes on, the borrowed amount increases due to the accumulation of interest rate. A collateralized position can become under-collateralized and subject to liquidation.</p> <p>In order to manage this liquidation, for all borrowers, their Excess Collateral (EC) is calculated. The excess collateral represents the quantity of asset deposited as collateral by the borrower but not yet required as collateral for borrower's various loans. It is calculated per borrower and includes all borrowing positions. It is not calculated for each borrowing position independently. Also the excess collateral is specific to each market.</p> <p>Excess collateral can decrease depending on two aspects:</p> <ul> <li>interest rate continue to accumulate, and excess collateral is gradually reduced</li> <li>the borrower opens up a new borrowing position, and excess collateral is reduced by the amount of required collateral needed for this position.</li> </ul> Calcul of the Excess Collateral (EC) <p>We need to define some variables :</p> <ul> <li>Total Collateral (TC) : The sum of all the assets deposited in limit orders as collateral by the borrower</li> <li>Required Collateral (RC) : The sum of collateral needed to repay all the borrowing positions, pay interest fees, and pay a possible price-based liquidation fee</li> <li>Liquidation Loan-To-Value (LLTV) : In order to liquidate the position before there really isn't enough collateral left, we add this variable. This provides a safety zone to protect lenders from borrowers\u2019 insolvency due to a growing debt burden. </li> </ul> <p>So we have :</p> <p> \\(EC=TC-\\dfrac{RC}{LLTV}\\) </p> <p>Excess collateral must always be positive. Otherwise, liquidation is at the initiative of external actors who receive in exchange a liquidation incentive (3%). </p> Example <p>In the ETH/USDC market, let's suppose that market price is equal to 2110 :</p> <ol> <li>Bob deposited 3 ETH as collateral as sell order in the Pool<sub>2200</sub>.</li> <li>Bob borrowed 5100 USDC from the Pool<sub>1818</sub> at limit price 1818. </li> <li>As time goes on, the collateral needed for his position is now up to 5454 USDC. This collateral represents 3 ETH (=5454/1818) meaning that Bob's Excess collateral is now equal to zero. Bob's borrowing position needs to be liquidated.</li> <li>Market price is still 2110. Carol takes Bob's position. So she repays Bob's debt to the Pool<sub>1818</sub> (5454 USDC). In exchange she gets 2.5848 ETH (=5454/2110) plus a 3% bonus of 0.078 ETH (=2.5848*0.03). So in total Carol trades 5454 USDC for 2.6628 ETH at market price 2110. </li> <li>Bob's remaining order in Pool<sub>2200</sub> is equal to 0.3372 ETH (=3-2.6628). Here Bob had to pay a liquidation fee of 0.078 ETH.</li> </ol>"},{"location":"how-it-works/market-participants/","title":"Market participants","text":"<p>There are three types of market participants in LendBook: lenders, borrowers, and takers.</p> <p> This diagram encapsulates the relationship of the market participants and LendBook, for a ETH/USDC market (Here lenders can lend USDC, borrowers can borrow USDC with ETH as collateral, and takers can trade USDC for ETH and vice versa).</p> <ul> <li> <p>Lenders : </p> <p>They deposit liquidity as limit orders at specified prices. These orders can be borrowed, which earns them interest.</p> <p> More information on lenders</p> </li> </ul> <p></p> <ul> <li> <p>Borrowers : </p> <p>They deposit collateral in an account (in the smart contract) in order to borrow assets posted by lenders. </p> <p>They pay interest rates on their borrowing positions. </p> <p> More information on borrowers</p> </li> </ul> <p></p> <ul> <li> <p>Takers : </p> <p>They can trade assets when market price reaches the limit price of orders they want to take.  They can take all or a portion of the non-borrowed part of limit orders. No fees applied on the trade. </p> <p> More information on takers</p> </li> </ul> <p></p>"},{"location":"how-it-works/max-loan-to-value/","title":"Max Loan-To-Value","text":"<p>The amount a borrower can borrow depends on the amount of collateral deposited.  In LendBook, the maximum Loan-To-Value (maxLTV) depends on two factors :</p> <ul> <li>the Liquidation LTV (LLTV) - The LLTV is set so that borrowers are not immediately put into liquidation when they seek to borrow the maximum amount (as they will have to pay interest charges). The LLTV is calculated to take into account the fact that the borrower has to pay a liquidation fee in the event of liquidation.</li> <li>distance of the pool's limit price to market price - the more the borrower borrows from a pool-of-orders whose limit price is close to the market price, the greater the LTV.</li> </ul> <p>So we have the maxLTV :  \\(maxLTV=LLTV\\times  \\dfrac{pool's\\ limit\\ price}{current\\ market\\ price}\\) </p> <p>The LLTV is defined based on the type of asset pair :</p> Asset tier LLTV Examples Pegged assets 99% DAI/USDC, wstETH/ETH Correlated assets 98% USDM/USDC, FRAX/USDC Volatile assets 96% ETH/USDC, WBTC/ETH Long-tail assets (in V2) 94% MKR/ETH, LINK/ETH <p>Example - Calcul of maxLTV</p> <p>In the ETH/USDC market, let's suppose the market price is 2110. For the ETH/USDC market, the LLTV is 96%.</p> <p>Bob deposits 2 ETH as a sell order in the Pool<sub>2200</sub> at limit price of 2200. </p> <p>Bob wants to calculate the max amount he can borrow based on the pool-of-orders he borrows from :</p> <ul> <li>for Pool<sub>2000</sub>, the limit price is 2000, so the maxLTV is equal to 91% (=0.96\u00d72000/2110). So Bob can borrow up to 3640 USDC (=220000.91) from Pool<sub>2000</sub>.</li> <li>for Pool<sub>1818</sub>, the limit price is 1818, so the maxLTV is equal to 82.7% (=0.96\u00d71818/2110). So Bob can borrow up to 3308 USDC (=218180.827) from Pool<sub>1818</sub>.</li> </ul>"},{"location":"how-it-works/pools-of-orders/","title":"Pools of orders","text":"<p>Lendbook is inspired by the logic of an order book, but it is not designed to replace traditional limit order book. To avoid diluting the lending liquidity across all possible prices, we introduce the notion of pools of limit orders.</p> <p>Lenders place orders within a restricted set of limit prices. All orders placed at the same limit price belong to the same pool of orders. Pools have their own limit price and are equally spaced by a multiplication factor. </p> <p>The interest rate is calculated per pool. It depends on the pool's utilization rate. Borrowers who borrow from a pool pay interest rates to the lenders in that same pool.</p> <p>This multiplication factor is unique for each pair of assets and it is defined at market creation. The value of this factor depends on the nature and volatility of the assets. If the assets are volatile, the factor will be set as high (e.g. step of 10% between each pool). If the assets are correlated or pegged, the factor will be set as low (e.g. step of 1% or 0.03% between each pool).</p> <p>Example</p> <p>For the ETH/USDC market, the step between each pool is defined as 10% (meaning \u00d71.10).</p> <p>Assuming the market price is 3100, the pools that are close to this price are : </p> <ul> <li>Pool<sub>3000</sub> with a limit price of 3000, </li> <li>Pool<sub>2727</sub> with a limit price of 2727 (=3000/1.10), </li> <li>Pool<sub>2479</sub> with a limit price of 2479 (=2727/1.10), </li> <li>and so on ...</li> </ul> <p> Depending on Alice's strategy, Alice can deposit assets in buy orders at limit prices of 3000 or 2727 or even under (but not in between). </p> <p> </p> <p></p> <p> Then, Bob deposits collateral in the protocol. Depending on his strategy, Bob can choose to borrow from the Pool<sub>3000</sub> or the Pool<sub>2727</sub> (or even under) :</p> <p> </p>"},{"location":"how-it-works/rules/","title":"Main Rules","text":"<p>The main rules are :</p> <ol> <li> <p>Limit orders can only be posted within a restricted range of limit prices.</p> <p>As mentioned in the pools of orders section, limit orders can be posted within a restricted set of pools. Each pool has an assigned limit price.</p> <p>Example</p> <p>In the ETH/USDC market, let's suppose the current market price is 3110.</p> <p>Alice deposits 6000 USDC as a buy order in the Pool<sub>3000</sub> at limit price of 3000. </p> </li> <li> <p>Assets which serve as collateral cannot be borrowed.</p> <p>Borrowers deposit collateral in the protocol. Collateral assets cannot be borrowed by another borrower.</p> </li> <li> <p>When part of the assets in a pool of orders are taken, positions borrowing from the pool are closed out.</p> <p>If the market price reaches the limit price of the pool, takers can trade part or all assets which are not borrowed in that pool. The trades liquidate the borrowing positions from the pool. Limit orders that have been borrowed are filled thanks to the collateral they receive from the borrowers.</p> <p>The market price is given by an oracle (Oracleless lending will be implemented in the V2 for long-tail assets).</p> <p>Example continued</p> <p>Bob deposits 1.5 ETH as collateral in the protocol and borrows 3600 USDC from the Pool<sub>3000</sub>. </p> <p>When market price reaches the limit price of Pool<sub>3000</sub> , a taker trades a portion of the assets that are not borrowed. This automatically closes Bob's position and Bob's collateral is transfered to Alice (and other lenders). </p> </li> <li> <p>Interest rates are shared between all lenders of the pool.</p> <p>Borrowers pay interest rates to all the lenders in the pool they borrow from. </p> <p>Check the interest rates section for more details.</p> </li> <li> <p>Liquidated borrowers pay a small liquidation fee to lenders.</p> <p>In the event of liquidation, liquidation fee is paid by borrowers to lenders. This liquidation fee exists to encourage borrowers to pay back their loans. Liquidation fees compensate lenders for receiving the collateral. </p> <p>There are two types of liquidations : interest-based liquidation and price-based liquidation. Check the liquidations section for more details.</p> <p>Example continued with the addition of a 4% liquidation fee (price-based liquidation)</p> <p>When market price reaches the limit price of Pool<sub>3000</sub> , a taker trades a portion of the assets that are not borrowed. This automatically closes Bob's position and Bob's collateral is transferred to Alice. </p> <p>Bob's loan is equal to 3600 USDC, so Bob's collateral is equal to 1.2 ETH (=3600/3000 where 3000 corresponds to the pool limit price.)</p> <p>Bob\u2019s collateral transferred to Alice is 1.2 + 1.2\u00d70.04 = 1.248 ETH (collateral + liquidation fee). </p> <p>Alice\u2019s remaining buy order 2400 USDC (=6000-3600) is filled for 0.8 ETH (=2400/3000). </p> <p>In total, Alice receives 2.048 ETH. For simplicity, interest rates are not included in this example.</p> </li> <li> <p>Assets whose orders have been filled are automatically placed as sell orders on the opposite side of the order book.</p> <p>When a buy order is filled, the converted assets are replaced as a new sell order on the other side of the order book. </p> <p>The new limit price may have been specified by the lender, or, in the absence of such specification, at the same limit price. By default, the order is placed in the same pool but as sell order (as it is the base asset). Lenders can then withdraw the assets or change the limit price if they wish. </p> <p>Once the market price crosses again the limit price of this pool, the sell orders are taken and the lender gets back his quote assets. In the same way, the quote asset are then placed as buy order in the same pool. These buy orders can now be borrowed.</p> <p>Example (follow up of example from rule 5)</p> <p>When market price reaches the limit price of Pool<sub>3000</sub> , Alice\u2019s buy order is filled, and so Alice receives 2.048 ETH. </p> <p>The protocol relocates the ETH (base asset) in a sell order which is located by default at the same limit price in the Pool<sub>3000</sub> because now the market price is under 3000 USDC. </p> </li> </ol>"},{"location":"introduction/tldr/","title":"TL;DR","text":"Too Long; Didn't Read <p>If you want to get an overview before digging in the documentation, here are the main things you need to know :</p> <ol> <li> <p>LendBook is a Lending Limit Order Book. Each market is isolated and collateral assets are not lent out to borrowers</p> </li> <li> <p>There are 3 types of market participants:</p> <ul> <li>Lenders post limit orders at specified prices which can be borrowed.</li> <li>Borrowers deposit collateral in order to borrow assets posted by lenders.</li> <li>Takers can   assets when the market price hits the order's limit price. No fees applied. </li> </ul> </li> <li> <p>Orders can only be posted within a restricted range of limit prices, known as pool-of-orders. Each pool-of-orders has an assigned limit price. Orders are grouped into pools to prevent liquidity dilution, allowing lenders to withdraw anytime as long as all there is non-borrowed liquidity in the pool.</p> </li> <li> <p>The interest rate is calculated per pool. It depends on the pool's utilization rate. Borrowers who borrow from a pool pay interest rates to the lenders who have supplied the pool.</p> </li> <li> <p>The market price is given by an oracle. When market price reaches the limit price of a pool-of-orders, borrowing positions from that pool are liquidated. Lenders receive the borrowers' collateral plus the interest rate and liquidation fee.</p> </li> <li> <p>There are 2 types of liquidations :</p> <ul> <li>Price-based liquidation when the market price reaches the pool limit price, borrowing positions are liquidated;</li> <li>Interest-based liquidation when a collateralized position becomes under-collateralized due to the accumulation of interest rate. In case of liquidation, borrowers need to pay a small liquidation fee.</li> </ul> </li> <li> <p>LendBook offers users multiple benefits:</p> <ul> <li>No bad debt \u2014 Borrowing positions cannot go under-collateralized</li> <li>No off-chain risk management \u2014 Risk management is on-chain and market-driven. The risk is not managed by DAOs or opaque curators.</li> <li>Simple debt management \u2014 Borrowers know the exact liquidation price in advance, not an approximation.</li> <li>Low liquidation cost \u2014 Liquidation fee = 3% for volatile assets (e.i. ETH/USDC market)</li> <li>High Loan-To-Value \u2014 MaxLTV = 96% for volatile assets</li> <li>High leverage \u2014 Max Theoretical Leverage is x25 for volatile assets</li> <li>Near zero governance \u2014 on the path to full decentralization.</li> </ul> </li> </ol>"},{"location":"others/questions/","title":"Questions/feedbacks","text":"<p>LendBook protocol is developed by the Breaking Labs team.</p> <p>We're listening to all our future users. If you have any feedback on LendBook, please don't hesitate to share it with us !</p> <p>Also we want to develop a protocol that everyone can understand. If you have any questions about the protocol, please let us know !</p> <p> Contact us on :</p> <ul> <li>Telegram - https://t.me/lend_book</li> <li>Discord - https://discord.com/invite/xQYtyQzqAu</li> <li>Twitter - https://twitter.com/lend_book</li> </ul> <p>If you want to read the whitepaper : Whitepaper link</p> <p>LendBook website : website link</p>"},{"location":"users/borrower/","title":"Borrower","text":"How do I borrow? <p>To borrow an asset, you need to choose the asset you wish to use as collateral and go to the corresponding market. For example, you might want to borrow USDC and use ETH as collateral, so you go to the ETH/USDC market.</p> <p>There is then a two-step process:</p> <ol> <li> <p>Before borrowing, you need to deposit some collateral in the protocol. </p> </li> <li> <p>Then you can borrow from a pool-of-orders. Each pool has its own limit price and its own interest rate (which depends on its utilization ratio).</p> <p>Depending on your strategy, you can borrow from a pool-of-orders close to or far away from the market price. It will determine :</p> <ul> <li>the maximum Loan-To-Value you can expect (Check out the LTV section for more details)</li> <li>and the price at which you can be liquidated (Check out the Stop Loss section for more details).</li> </ul> </li> </ol> Example <p>Bob wants to borrow USDC. He choose to use ETH as collateral. So he goes to the ETH/USDC market.</p> <p>Let's suppose market price is 3100.</p> <p>Bob deposits some ETH as collateral in the protocol.</p> <p>Then Bob borrows from Pool<sub>3000</sub>. Positions borrowed from this will be liquidated if the market price reaches 3000.</p> How much I can borrow? <p>The maximum amount you can borrow depends on the value you have supplied as collateral and the available liquidity in each pool. </p> <p>You can not borrow assets from a pool if the utilization rate of that pool is equal to 100%. In addition you might not borrow asset if your Excess collateral is close to 0 otherwise your other borrowing positions might be subject to an interest-based liquidation (Check out the Liquidation fees section for more details).</p> What asset do I need to repay? <p>You repay your loan in the same asset you borrowed. For example, if you borrow 1 ETH you will pay back 1 ETH + interest accrued.</p> How much would I pay in interest? <p>The interest rate you pay for borrowing assets may fluctuate over time. It depends on the utilization rate of the pool you borrowed from. The utilization rate is derived from the supply and demand ratio of the asset. Check out the Interest rates section for more details.</p> When do I need to pay back the loan? <p>There is no fixed time period to pay back the loan. As long as your position is safe, you can borrow for an undefined period. However, as time passes, the accrued interest will grow, causing a decrease in your excess collateral, which could make this position liquidatable in the near future. Check out the Liquidation fees section for more details.</p> What happens if my Excess collateral is near zero ? <p>If your excess collateral is near zero, it means that you won't be able to continue paying the interest rates that accumulate over time. One of your borrowing positions will soon be liquidated if you do nothing (Check out the Liquidation fees section for more details).</p> <p>In order not to lose part (3%) of the required collateral used for the borrowing position which is about to be liquidated, you might want to :</p> <ul> <li>deposit more collateral as new limit orders</li> <li>or repay one of your borrowing positions</li> </ul> How do I pay back the loan? <p>In order to repay the loan you simply go to the Borrow page and the Repay section. Select the borrowing position you want to repay, the amount to repay and confirm the transaction.</p> How do I avoid liquidation? <p>As described in the Liquidation fees section, there are two types of liquidations in LendBook :</p> <ul> <li> <p>Price-based liquidation - It's when the market price reaches the pool limit price, borrowing positions are liquidated. If price-based liquidation occurs, it will cost you a liquidation fee. To avoid this liquidation, you must repay your loan before the market price reaches the limit price of the pool you borrowed from.</p> </li> <li> <p>Interest-based liquidation - It's when a collateralized position becomes under-collateralized due to the accumulation of interest rate. If interest-based liquidation occurs, it will cost you a liquidation penalty. To avoid this liquidation, we advise you to repay your loan or deposit more collateral before the excess collateral reaches zero.</p> </li> </ul>"},{"location":"users/lender/","title":"Lender","text":"How do I supply? <p>First, you need to choose the quote asset to supply and the market in which you want to supply. For example, you might want to supply USDC in the ETH/USDC market.</p> <p>Then, depending on your strategy, you can choose in which pool-of-orders you want to post your quote asset as a limit order. Indeed, you can deposit in a pool-of-orders close to or far away from the market price.</p> How much will I earn? <p>There are two sources of earnings :</p> <ul> <li>Interest rates - In each pool, lenders share the interests paid by borrowers. The interest rate you earn depends on the utilization rate of the pool you deposited in. The interest rate can fluctuate over time.</li> <li>liquidation fees - You earn a liquidation fee when your order is filled if there are borrowing positions that have been liquidated</li> </ul> What happens when my limit order is filled? <p>When market price reaches the limit price of the pool, takers can trade part of assets which are in that pool. The trades made by takers will liquidate the borrowing positions in that pool. </p> <p>When your limit order is filled, you will receive the base asset. Although the origin of the base asset does not affect the lender, here are the two possible origins of the base asset :</p> <ul> <li>the non-borrowable liquidity inside your pool was taken by takers, so part of base assets is coming from takers</li> <li>borrowing positions were liquidated in your pool, so the other part of base assets is the collateral of the borrowers</li> </ul> <p>When your order is filled, and there are borrowing positions that have been liquidated, lenders from the pool receive and share liquidation fees paid by the borrowers (in addition to the interest rates).</p> I want to earn interest but I want to keep my asset at the end. What should I do ? <p>You have supplied quote asset in order to earn interest rates but you do not want your asset to be trade into the base asset. Here is what you can do :</p> <ul> <li> <p>you can track the market price and withdraw your supply before the market price reaches the limit price of the pool you deposited in. Keep in mind that the utilization rate of this pool must be under 100% in order to withdraw your supply. If you wish to continue earning interest and keep your quote asset, once you have withdrawn your asset, you can deposit in a pool with a lower price limit.</p> </li> <li> <p>you can wait for your order to be filled. You will receive the base asset plus liquidation fees. You then go to your favorite decentralize exchange to swap back the base asset you received into the quote asset. The liquidation fees you earn should cover the price slippage you may encounter.</p> </li> </ul> How do I withdraw? <p>To withdraw you need to go to the \"Lend to earn\" page and the Withdraw section. Select the limit order you wish to withdraw, the amount to withdraw and submit the transaction.</p> <p>You would need to make sure there is enough available liquidity (not borrowed) in the pool in order to withdraw. If the utilization rate of the pool is near 100%, you would need to wait for more liquidity to enter from lenders or wait for borrowers to repay some of the borrowing positions. </p>"},{"location":"users/taker/","title":"Taker","text":"Why would I want to be a taker? <p>Unlike common Decentralize Exchanges (DEXs), takers do not pay any fees for swapping assets.</p> <p>Takers can swap an asset for another asset if the market price reaches the limit price of a pool-of-orders. Takers can take all the non-borrowable liquidity in a pool.</p> Why are there no fees for swapping assets? <p>Takers swap the remaining available assets in tradeable pools. A tradeable pool of loan assets is a pool whose limit price is above market price. Trades by takers signal eligibility of all borrowing positions of the pool to liquidation. Liquidations are triggered and processed atomically with takers' trades, so that when all remaining assets are taken by takers, all borrowing positions are also liquidated.</p> Who are the takers? <p>Takers can have different profils :</p> <ul> <li> <p>A user who go to the \"Take\" section, he selects the limit order he wish to take, he select the amount to take and submit the transaction.</p> </li> <li> <p>A user who uses Decentralize Exchange (DEX) Aggregators. LendBook will be integrated to DEX aggregators.</p> </li> <li> <p>A bot who find arbitrage opportunities by becoming a taker on LendBook.</p> </li> </ul> What about the 3% bonus when there is an interest-based liquidation? <p>Good point, it means that you've read the liquidation fees section </p> <p>As time goes on, the borrowed amount of a borrower increases due to the accumulation of interest rate. A collateralized position can become under-collateralized and subject to liquidation. This type of liquidation is called interest-based liquidation.</p> <p>The orders which are subject to liquidation are showed in the \"Take\" section. The taker can select the amount to take and submit the transaction. He will get a 3% bonus on the amount he takes.</p> Example <p>In the ETH/USDC market, let's suppose that market price is equal to 2110 :</p> <ol> <li>Bob has deposited 3 ETH as collateral as sell order in the Pool<sub>2200</sub>.</li> <li>Bob borrowed 5100 USDC from the Pool<sub>1818</sub> at limit price 1818. </li> <li>As time goes on, the collateral needed for this position is now up to 5454 USDC. This collateral represents 3 ETH (=5454/1818) meaning that Bob's Excess collateral is now equal to zero. Bob's borrowing position needs to be liquidated.</li> <li>Market price is still 2110. Carol takes Bob's position. So she repays Bob's debt to the Pool<sub>1818</sub> (5454 USDC). And in exchange she gets 2.5848 ETH (=5454/2110) plus a 3% bonus of 0.078 ETH (=2.5848*0.03). So in total Carol trades 5454 USDC for 2.6628 ETH at market price 2110. </li> <li>Bob's remaining order in Pool<sub>2200</sub> is equal to 0.3372 ETH (=3-2.6628). Here Bob had to pay a liquidation fee of 0.078 ETH.</li> </ol>"}]}